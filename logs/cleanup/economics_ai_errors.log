{"timestamp": "2025-07-21T22:33:13.337953", "level": "ERROR", "logger": "cleanup_workflow", "message": "Error analyzing source 3: Execution failed on sql '\n        SELECT id, name, file_path, extraction_date\n        FROM data_sources\n        WHERE id = ?\n        ': no such table: data_sources", "module": "run_source_cleanup", "function": "analyze_source", "line": 131}
{"timestamp": "2025-07-21T22:33:13.344329", "level": "ERROR", "logger": "cleanup_operations", "message": "Error during cleanup: Execution failed on sql '\n        SELECT id, name, file_path, extraction_date\n        FROM data_sources\n        WHERE id = ?\n        ': no such table: data_sources", "module": "logging_config", "function": "log_error", "line": 89, "source_id": 3, "operation": "cleanup_error", "error_type": "DatabaseError", "exception": "Traceback (most recent call last):\n  File \"C:\\Users\\Robert Casanova\\AppData\\Roaming\\Python\\Python313\\site-packages\\pandas\\io\\sql.py\", line 2664, in execute\n    cur.execute(sql, *args)\n    ~~~~~~~~~~~^^^^^^^^^^^^\nsqlite3.OperationalError: no such table: data_sources\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\Robert Casanova\\OneDrive\\Documents\\economics-ai-dashboard-v2\\src\\pipeline\\run_source_cleanup.py\", line 96, in analyze_source\n    source_info = self.get_source_info(source_id)\n  File \"C:\\Users\\Robert Casanova\\OneDrive\\Documents\\economics-ai-dashboard-v2\\src\\pipeline\\run_source_cleanup.py\", line 77, in get_source_info\n    result = pd.read_sql_query(query, conn, params=[source_id])\n  File \"C:\\Users\\Robert Casanova\\AppData\\Roaming\\Python\\Python313\\site-packages\\pandas\\io\\sql.py\", line 528, in read_sql_query\n    return pandas_sql.read_query(\n           ~~~~~~~~~~~~~~~~~~~~~^\n        sql,\n        ^^^^\n    ...<6 lines>...\n        dtype_backend=dtype_backend,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\Robert Casanova\\AppData\\Roaming\\Python\\Python313\\site-packages\\pandas\\io\\sql.py\", line 2728, in read_query\n    cursor = self.execute(sql, params)\n  File \"C:\\Users\\Robert Casanova\\AppData\\Roaming\\Python\\Python313\\site-packages\\pandas\\io\\sql.py\", line 2676, in execute\n    raise ex from exc\npandas.errors.DatabaseError: Execution failed on sql '\n        SELECT id, name, file_path, extraction_date\n        FROM data_sources\n        WHERE id = ?\n        ': no such table: data_sources"}
{"timestamp": "2025-07-21T22:33:13.345127", "level": "ERROR", "logger": "cleanup_workflow", "message": "Failed to process source 3: Execution failed on sql '\n        SELECT id, name, file_path, extraction_date\n        FROM data_sources\n        WHERE id = ?\n        ': no such table: data_sources", "module": "run_source_cleanup", "function": "cleanup_multiple_sources", "line": 282}
{"timestamp": "2025-07-21T22:33:13.347557", "level": "ERROR", "logger": "cleanup_operations", "message": "Error during cleanup: Execution failed on sql '\n        SELECT id, name, file_path, extraction_date\n        FROM data_sources\n        WHERE id = ?\n        ': no such table: data_sources", "module": "logging_config", "function": "log_error", "line": 89, "source_id": 3, "operation": "cleanup_error", "error_type": "DatabaseError", "exception": "Traceback (most recent call last):\n  File \"C:\\Users\\Robert Casanova\\AppData\\Roaming\\Python\\Python313\\site-packages\\pandas\\io\\sql.py\", line 2664, in execute\n    cur.execute(sql, *args)\n    ~~~~~~~~~~~^^^^^^^^^^^^\nsqlite3.OperationalError: no such table: data_sources\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\Robert Casanova\\OneDrive\\Documents\\economics-ai-dashboard-v2\\src\\pipeline\\run_source_cleanup.py\", line 272, in cleanup_multiple_sources\n    self.analyze_source(source_id, current_file)\n    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\Robert Casanova\\OneDrive\\Documents\\economics-ai-dashboard-v2\\src\\pipeline\\run_source_cleanup.py\", line 96, in analyze_source\n    source_info = self.get_source_info(source_id)\n  File \"C:\\Users\\Robert Casanova\\OneDrive\\Documents\\economics-ai-dashboard-v2\\src\\pipeline\\run_source_cleanup.py\", line 77, in get_source_info\n    result = pd.read_sql_query(query, conn, params=[source_id])\n  File \"C:\\Users\\Robert Casanova\\AppData\\Roaming\\Python\\Python313\\site-packages\\pandas\\io\\sql.py\", line 528, in read_sql_query\n    return pandas_sql.read_query(\n           ~~~~~~~~~~~~~~~~~~~~~^\n        sql,\n        ^^^^\n    ...<6 lines>...\n        dtype_backend=dtype_backend,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\Robert Casanova\\AppData\\Roaming\\Python\\Python313\\site-packages\\pandas\\io\\sql.py\", line 2728, in read_query\n    cursor = self.execute(sql, params)\n  File \"C:\\Users\\Robert Casanova\\AppData\\Roaming\\Python\\Python313\\site-packages\\pandas\\io\\sql.py\", line 2676, in execute\n    raise ex from exc\npandas.errors.DatabaseError: Execution failed on sql '\n        SELECT id, name, file_path, extraction_date\n        FROM data_sources\n        WHERE id = ?\n        ': no such table: data_sources"}
{"timestamp": "2025-07-21T22:34:13.713436", "level": "ERROR", "logger": "cleanup_workflow", "message": "Error analyzing source 3: Execution failed on sql '\n        SELECT id, name, file_path, extraction_date\n        FROM data_sources\n        WHERE id = ?\n        ': no such table: data_sources", "module": "run_source_cleanup", "function": "analyze_source", "line": 131}
{"timestamp": "2025-07-21T22:34:13.727057", "level": "ERROR", "logger": "cleanup_operations", "message": "Error during cleanup: Execution failed on sql '\n        SELECT id, name, file_path, extraction_date\n        FROM data_sources\n        WHERE id = ?\n        ': no such table: data_sources", "module": "logging_config", "function": "log_error", "line": 89, "source_id": 3, "operation": "cleanup_error", "error_type": "DatabaseError", "exception": "Traceback (most recent call last):\n  File \"C:\\Users\\Robert Casanova\\AppData\\Roaming\\Python\\Python313\\site-packages\\pandas\\io\\sql.py\", line 2664, in execute\n    cur.execute(sql, *args)\n    ~~~~~~~~~~~^^^^^^^^^^^^\nsqlite3.OperationalError: no such table: data_sources\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\Robert Casanova\\OneDrive\\Documents\\economics-ai-dashboard-v2\\src\\pipeline\\run_source_cleanup.py\", line 96, in analyze_source\n    source_info = self.get_source_info(source_id)\n  File \"C:\\Users\\Robert Casanova\\OneDrive\\Documents\\economics-ai-dashboard-v2\\src\\pipeline\\run_source_cleanup.py\", line 77, in get_source_info\n    result = pd.read_sql_query(query, conn, params=[source_id])\n  File \"C:\\Users\\Robert Casanova\\AppData\\Roaming\\Python\\Python313\\site-packages\\pandas\\io\\sql.py\", line 528, in read_sql_query\n    return pandas_sql.read_query(\n           ~~~~~~~~~~~~~~~~~~~~~^\n        sql,\n        ^^^^\n    ...<6 lines>...\n        dtype_backend=dtype_backend,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\Robert Casanova\\AppData\\Roaming\\Python\\Python313\\site-packages\\pandas\\io\\sql.py\", line 2728, in read_query\n    cursor = self.execute(sql, params)\n  File \"C:\\Users\\Robert Casanova\\AppData\\Roaming\\Python\\Python313\\site-packages\\pandas\\io\\sql.py\", line 2676, in execute\n    raise ex from exc\npandas.errors.DatabaseError: Execution failed on sql '\n        SELECT id, name, file_path, extraction_date\n        FROM data_sources\n        WHERE id = ?\n        ': no such table: data_sources"}
{"timestamp": "2025-07-21T22:34:13.727697", "level": "ERROR", "logger": "cleanup_workflow", "message": "Failed to process source 3: Execution failed on sql '\n        SELECT id, name, file_path, extraction_date\n        FROM data_sources\n        WHERE id = ?\n        ': no such table: data_sources", "module": "run_source_cleanup", "function": "cleanup_multiple_sources", "line": 282}
{"timestamp": "2025-07-21T22:34:13.733873", "level": "ERROR", "logger": "cleanup_operations", "message": "Error during cleanup: Execution failed on sql '\n        SELECT id, name, file_path, extraction_date\n        FROM data_sources\n        WHERE id = ?\n        ': no such table: data_sources", "module": "logging_config", "function": "log_error", "line": 89, "source_id": 3, "operation": "cleanup_error", "error_type": "DatabaseError", "exception": "Traceback (most recent call last):\n  File \"C:\\Users\\Robert Casanova\\AppData\\Roaming\\Python\\Python313\\site-packages\\pandas\\io\\sql.py\", line 2664, in execute\n    cur.execute(sql, *args)\n    ~~~~~~~~~~~^^^^^^^^^^^^\nsqlite3.OperationalError: no such table: data_sources\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"C:\\Users\\Robert Casanova\\OneDrive\\Documents\\economics-ai-dashboard-v2\\src\\pipeline\\run_source_cleanup.py\", line 272, in cleanup_multiple_sources\n    self.analyze_source(source_id, current_file)\n    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"C:\\Users\\Robert Casanova\\OneDrive\\Documents\\economics-ai-dashboard-v2\\src\\pipeline\\run_source_cleanup.py\", line 96, in analyze_source\n    source_info = self.get_source_info(source_id)\n  File \"C:\\Users\\Robert Casanova\\OneDrive\\Documents\\economics-ai-dashboard-v2\\src\\pipeline\\run_source_cleanup.py\", line 77, in get_source_info\n    result = pd.read_sql_query(query, conn, params=[source_id])\n  File \"C:\\Users\\Robert Casanova\\AppData\\Roaming\\Python\\Python313\\site-packages\\pandas\\io\\sql.py\", line 528, in read_sql_query\n    return pandas_sql.read_query(\n           ~~~~~~~~~~~~~~~~~~~~~^\n        sql,\n        ^^^^\n    ...<6 lines>...\n        dtype_backend=dtype_backend,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"C:\\Users\\Robert Casanova\\AppData\\Roaming\\Python\\Python313\\site-packages\\pandas\\io\\sql.py\", line 2728, in read_query\n    cursor = self.execute(sql, params)\n  File \"C:\\Users\\Robert Casanova\\AppData\\Roaming\\Python\\Python313\\site-packages\\pandas\\io\\sql.py\", line 2676, in execute\n    raise ex from exc\npandas.errors.DatabaseError: Execution failed on sql '\n        SELECT id, name, file_path, extraction_date\n        FROM data_sources\n        WHERE id = ?\n        ': no such table: data_sources"}
{"timestamp": "2025-07-21T22:44:28.065206", "level": "ERROR", "logger": "cleanup_workflow", "message": "Failed to process source 3: Database not found at data\\database\\economics_ai.db", "module": "run_source_cleanup", "function": "cleanup_multiple_sources", "line": 260}
{"timestamp": "2025-07-21T22:44:28.067231", "level": "ERROR", "logger": "cleanup_operations", "message": "Error during cleanup: Database not found at data\\database\\economics_ai.db", "module": "logging_config", "function": "log_error", "line": 89, "source_id": 3, "operation": "cleanup_error", "error_type": "FileNotFoundError", "exception": "Traceback (most recent call last):\n  File \"C:\\Users\\Robert Casanova\\OneDrive\\Documents\\economics-ai-dashboard-v2\\src\\pipeline\\run_source_cleanup.py\", line 253, in cleanup_multiple_sources\n    new_file = self.execute_cleanup(source_id, current_file, auto_confirm)\n  File \"C:\\Users\\Robert Casanova\\OneDrive\\Documents\\economics-ai-dashboard-v2\\src\\pipeline\\run_source_cleanup.py\", line 129, in execute_cleanup\n    backup_path = self.backup_manager.create_backup(\n        tag=\"_cleanup\",\n        source_id=source_id\n    )\n  File \"C:\\Users\\Robert Casanova\\OneDrive\\Documents\\economics-ai-dashboard-v2\\src\\utils\\backup_manager.py\", line 68, in create_backup\n    raise FileNotFoundError(f\"Database not found at {self.db_path}\")\nFileNotFoundError: Database not found at data\\database\\economics_ai.db"}
{"timestamp": "2025-07-21T22:46:52.356746", "level": "ERROR", "logger": "cleanup_workflow", "message": "Failed to process source 3: EOF when reading a line", "module": "run_source_cleanup", "function": "cleanup_multiple_sources", "line": 260}
{"timestamp": "2025-07-21T22:46:52.358221", "level": "ERROR", "logger": "cleanup_operations", "message": "Error during cleanup: EOF when reading a line", "module": "logging_config", "function": "log_error", "line": 89, "source_id": 3, "operation": "cleanup_error", "error_type": "EOFError", "exception": "Traceback (most recent call last):\n  File \"C:\\Users\\Robert Casanova\\OneDrive\\Documents\\economics-ai-dashboard-v2\\src\\pipeline\\run_source_cleanup.py\", line 253, in cleanup_multiple_sources\n    new_file = self.execute_cleanup(source_id, current_file, auto_confirm)\n  File \"C:\\Users\\Robert Casanova\\OneDrive\\Documents\\economics-ai-dashboard-v2\\src\\pipeline\\run_source_cleanup.py\", line 156, in execute_cleanup\n    response = input(\"\\nProceed with cleanup? (yes/no): \").lower().strip()\n               ~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nEOFError: EOF when reading a line"}
